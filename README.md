# PR Comments Analyzer

Analyze GitHub PR review activity across an organization. Includes a Python collector and React dashboard.

## Structure

```
comments/
├── collector/     # Python CLI to fetch PR data from GitHub
└── dashboard/     # React dashboard to visualize the data
```

## Collector

### Installation

```bash
cd collector
pip install -e .
```

### Usage

```bash
# With personal access token
gh-pr-comments --org <org-name> --token <github-token> --since 2024-01-01

# With environment variable
export GITHUB_TOKEN=<token>
gh-pr-comments --org <org-name> --since 2024-01-01

# Output to specific file
gh-pr-comments --org <org-name> --output report.json
```

### Options

| Option | Description |
|--------|-------------|
| `--org` | GitHub organization name (required) |
| `--token` | GitHub Personal Access Token |
| `--since` | Start date (YYYY-MM-DD) |
| `--until` | End date (YYYY-MM-DD) |
| `--output` | Output file (default: `{org}.json`) |
| `--verbose` | Enable verbose logging |

### Output JSON Structure

The collector outputs raw PR event data. Each PR contains a chronological list of events. The file is saved incrementally after each repository is processed.

```json
{
  "organization": "example-org",
  "generated_at": "2024-01-15T12:00:00+00:00",
  "date_range": {
    "since": "2024-01-01",
    "until": "2024-01-15"
  },
  "repositories": {
    "repo-name": [
      {
        "number": 123,
        "title": "Add new feature",
        "events": [
          {"type": "created", "date": "2024-01-10T10:00:00", "person": "author"},
          {"type": "comment", "date": "2024-01-10T14:30:00", "person": "reviewer1"},
          {"type": "comment", "date": "2024-01-11T09:00:00", "person": "reviewer2"},
          {"type": "merged", "date": "2024-01-11T15:00:00", "person": "author"}
        ]
      }
    ]
  }
}
```

Event types:
- `created`: PR was opened
- `comment`: Review comment, issue comment, or review body
- `merged`: PR was merged
- `closed`: PR was closed without merging

## Dashboard

### Installation

```bash
cd dashboard
npm install
```

### Development

```bash
npm run dev
```

Open http://localhost:5173 and upload the JSON file generated by the collector.

### Charts

- Total comments by person
- Avg comments per PR by person
- PRs created by person
- PRs merged by person
- PRs by repository (open/merged/closed)
- Avg time to first comment by repo
- Avg time to close by repo
- Bot filtering toggle
